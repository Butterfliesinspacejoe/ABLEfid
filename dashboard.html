<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ABLEfid — Dashboard</title>
  <link rel="stylesheet" href="assets/ablefid.css">
  <!-- Magic UMD (exposes window.Magic) -->
  <script src="https://cdn.jsdelivr.net/npm/magic-sdk@latest/dist/magic.js"></script>
</head>
<body>
  <div class="container">
    <header aria-label="Site header">
      <a href="index.html" class="brand" aria-label="ABLEfid home">
        <img src="assets/logo.png" alt="ABLEfid logo" class="logo-img" />
        <span class="brand-name">ABLEfid</span>
      </a>
      <nav class="nav-actions" aria-label="Primary">
        <button class="btn btn-outline" id="logoutBtn">Logout</button>
      </nav>
    </header>

    <section class="hero" style="padding-top:32px">
      <h1 class="title">Welcome to your Dashboard</h1>
      <p class="subtitle">Below is your session info. Use this page to wire wallet actions next.</p>

      <article class="card" id="userCard">
        <h3>Session</h3>
        <pre id="userJson" style="white-space:pre-wrap;margin:0;color:#0f172a;background:#f8fafc;padding:12px;border-radius:10px;border:1px solid #e2e8f0;"></pre>
      </article>

      <div class="cta" style="margin-top:16px">
        <a class="btn btn-primary" href="#" id="actionSend">Send USDC (placeholder)</a>
        <a class="btn btn-outline" href="#" id="actionReceive">Show Address (placeholder)</a>
      </div>
    </section>

    <!-- Wallet mapping panels (inside container for styling) -->
    <section class="card">
      <h3>Lookup Wallet Mapping</h3>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <input id="uuidInput" placeholder="user-uuid-123" />
        <button id="getWalletBtn" class="btn primary">Get Wallet</button>
      </div>
      <div id="walletResult" class="subtitle" style="margin-top:8px"></div>
    </section>

    <section class="card">
      <h3>Admin: Set Mapping</h3>
      <div style="display:flex;gap:8px;flex-wrap:wrap;margin:8px 0">
        <input id="uuidSet" placeholder="user-uuid-123" />
        <input id="addrSet" placeholder="0xAbc123..." />
        <button id="btnSet" class="btn">Set Wallet</button>
      </div>
      <div id="outSet" class="subtitle"></div>
      <small>Note: this sends a transaction; you’ll need test gas on Flow EVM Testnet.</small>
    </section>

    <footer>
      <span id="year"></span> © ABLEfid. All rights reserved.
    </footer>
  </div>

  <script>
    // Footer year
    const yearEl=document.getElementById('year'); if(yearEl) yearEl.textContent=new Date().getFullYear();

    // Minimal session gate using localStorage
    const sessionOk = local
